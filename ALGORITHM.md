# WhiskyBob Recommendation Engine: Technical Overview

## 1. Overview
The WhiskyBob recommendation system uses user preference analysis and similarity techniques to suggest personalized whisky bottles. The algorithm is primarily implemented in the `WhiskyRecommender` class (`recommendation_engine.py`).

---

## 2. Recommendation Pipeline

### a) **Input**
- User's collection data (bar data) fetched from the BAXUS API.
- Each item contains information such as: name, brand, spirit type, price, proof, region, age, and image.

### b) **Preprocessing**
- Conversion of null fields to default values (e.g., price 0, age 0/NAS).
- Creation of a pandas DataFrame for efficient data manipulation.
- Generation of dummy columns for categorical variables (spirit, region, brand).

### c) **User Profile Extraction**
- Calculation of statistics such as average price, price range, favorite spirits and regions, preferred brands, average age, and proof.

### d) **Recommendation Generation**
- **Similar Bottles:**  
  - Vectorization of the user's whiskies.
  - Calculation of the mean of the user's feature vectors.
  - Cosine similarity calculation between the user's profile and all whiskies in the database.
  - Selection of the most similar bottles (excluding those already in the user's collection).
- **Complementary Bottles:**  
  - Search for bottles that bring diversity (new spirits, regions, brands, ages, or proofs).

### e) **Recommendation Explanation**
- For each recommended bottle, a personalized explanation is generated via LLM (Groq), based on the user's profile and the bottle's characteristics.

---

## 3. Main Functions

- `get_recommendations(bar_data, num_recommendations=5)`: Main pipeline, returns user profile, similar and complementary recommendations, and statistics.
- `analyze_user_preferences(user_df)`: Extracts user preferences.
- `find_similar_bottles(user_df, num_recommendations, user_profile)`: Finds similar bottles using cosine similarity.
- `find_complementary_bottles(user_df, user_profile, num_recommendations)`: Finds bottles that diversify the collection.
- `generate_llm_message(bottle, user_profile)`: Generates a personalized explanation via LLM.

---

## 4. Technologies Used

- **Python, Flask** (backend)
- **Pandas, scikit-learn** (data manipulation and similarity calculation)
- **Bootstrap** (frontend)
- **Groq LLM API** (natural language explanations)
- **BAXUS API** (user data)

---

## 5. Summary Flow

1. The user enters their BAXUS username.
2. The system fetches the user's collection from the API.
3. The algorithm processes the data, extracts the profile, and generates recommendations.
4. For each recommendation, an explanation is generated by the LLM.
5. Results are displayed in the frontend with detailed explanations.

---

## 6. Future Extensions

- Support for advanced filters (price, region, etc.)
- Adjustment of algorithm parameters via the interface
- User feedback to improve suggestions

---

### Contributing
Suggestions and improvements are welcome. See the code in `recommendation_engine.py` for implementation details.
